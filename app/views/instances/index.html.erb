<%= render partial: "pages/cookielaw" %>
<%= render partial: "pages/header" %>

<div class="row">
  <p>&nbsp;</p>

<h2><%= @entity.plurale %>
<%= link_to "Nuovo", new_instance_path + "?type=#{ @entity.slug }", class: 'large warning button float-right' if @entity %>
<% if @entity %><%= link_to 'Xlsx', instances_path(format: :xlsx) + "?type=#{ @entity.slug }", class: 'large primary button float-right' %><% end %>
</h2>
<span class="secondary label"><%= @numero %> elementi</span>

<table>
  <thead>
    <tr>
      <th><%= @entity.label %></th>
      <% if current_user.admin? %>
          <th>Creato da</th>
          <th>Appartenenza</th>
          <th>Ultima modifica</th>
      <% end %>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @instances.each do |instance| %>
      <tr>
        <% if current_user.admin? || instance.entity.stato == 1 %>
          <td><%= link_to instance.label, edit_instance_path(instance) %></td>
        <% else %>
          <td><%= link_to instance.label, instance_path(instance) %></td>
        <% end %>
        <% if current_user.admin? %>
            <td class="testo_piccolo"><%= instance.user.email if instance.user %></td>
            <td class="testo_piccolo"><%= instance.user.appartenenza if instance.user %></td>
            <td class="testo_piccolo"><%= instance.updated_at.to_s(:data_ora) %></td>
        <% end %>
        <% if current_user.admin? || instance.entity.stato == 1 %>
          <td><%= link_to 'Elimina', instance, method: :delete, data: { confirm: 'Are you sure?' }, class: 'small alert button' %></td>
        <% else %>
          <td>&nbsp;</td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

  <p>&nbsp;</p>
</div>

<div class="text-center">
  <%= will_paginate @instances, renderer: FoundationPagination::Rails %>
</div>

<%= render partial: "pages/footer" %>